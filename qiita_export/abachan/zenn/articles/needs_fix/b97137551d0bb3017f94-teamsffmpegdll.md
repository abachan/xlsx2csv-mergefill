---
title: "Teams起動時に「ffmpeg.dll が見つからない」エラーが毎回表示される問題の対処法"
emoji: "📝"
type: "tech"
topics:[windows,ffmpeg,teams]
published: false
---

<!-- TODO: 以下を調整 -->
<!-- - Qiita画像ホスティング -->
<!-- - トピック数/形式の調整 -->
<!--   * そのままでも表示可。GitHub連携で運用する場合は画像を保存して相対パスへ書換推奨 -->
<!--   * Zennのtopicsは最大5・半角英数とハイフンのみ。候補: windows, ffmpeg, teams -->

## はじめに

ある日突然、PCを起動するたびに以下のようなエラーが表示されるようになりました。
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3963503/51d286db-360f-4558-84ff-fad1c087d4a6.png)

エラーメッセージが表示されるものの、Teams自体は問題なく起動し、ビデオ会議やチャットも通常通り使えていました。実害がないためしばらく放置していたのですが、毎回表示されるのがとにかく煩わしく、本格的に対策することにしました。

## 試したこと①：アンインストールと再インストール（効果なし）

エラーメッセージに「プログラムを再インストールすると、この問題が解決する可能性があります」と書かれていたため、素直にそれに従ってみることに。

コントロールパネルの「インストールされているアプリ」から、
* **Microsoft Teams**
* **Teams Machine-Wide Installer**

の2つをアンインストールし、
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3963503/36e252a2-4061-4243-9e13-46a58ccb7034.png)

公式サイトから最新版のTeamsをダウンロードして再インストールしました。

しかし、結果は変わらず...。PCを再起動すると、同じエラーが再び表示されました。

## 試したこと②：Teamsのキャッシュフォルダを削除（効果あり！）

再インストールでダメだったので、設定ファイルやキャッシュが悪さをしているのではないかと考え、次の対策を試みました。

1.  Teamsのプロセスを完全に終了させます。
2.  `Win` + `R` キーで「ファイル名を指定して実行」を開きます。
3.  以下のパスを入力し、「OK」をクリックします。
    ```
    %LocalAppData%\Microsoft\Teams\
    ```
4.  開いたフォルダの中にあるファイルやフォルダを**全て削除**します。
5.  PCを**再起動**します。

再起動後、Teamsが初回起動時のように立ち上がりました。そして、あれだけしつこく表示されていた「ffmpeg.dll が見つからない」のエラーが、ついに表示されなくなりました！

## まとめ

Teamsの「ffmpeg.dll が見つからない」エラーは、**再インストールでは治らず、`%LocalAppData%\Microsoft\Teams\` フォルダを削除することで解決**しました。
どうやら、Teamsのキャッシュや一時ファイルが何らかの原因で破損し、エラーを引き起こしていたようです。

同じエラーでお困りの方は、ぜひこの方法を試してみてください。誰かのお役に立てれば幸いです。
